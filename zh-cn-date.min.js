"use strict";function getdate(e){function t(e){"Invalid Date"!=new Date(e)&&e||(e=new Date);var t={};return a.forEach(function(a,r){var n=new Date(e)["get"+a.key]();2===r&&n++,n<10&&r>1&&(n="0"+n),"W"===a.value&&(0===n&&(n=7),t.w="周"+a.format[n-1]),t[a.value]=n}),t.Date=new Date(e),t}var a=[{value:"W",key:"Day",index:1,text:"周",format:["一","二","三","四","五","六","日"]},{value:"Y",key:"FullYear",index:4,text:"年",format:"YYYY",replace:"-",reg:"^[0-9]{3}[1-9]|[0-9]{2}[1-9][0-9]{1}|[0-9]{1}[1-9][0-9]{2}|[1-9][0-9]{3}$"},{value:"M",key:"Month",index:2,text:"月",format:"YYYY-MM",replace:"-"},{value:"D",key:"Date",index:2,text:"日",format:"YYYY-MM-DD",replace:" "},{value:"h",key:"Hours",index:2,text:"时",format:"YYYY-MM-DD hh",replace:":"},{value:"m",key:"Minutes",index:2,text:"分",format:"YYYY-MM-DD hh:mm",replace:":"},{value:"s",key:"Seconds",index:2,text:"秒",format:"YYYY-MM-DD hh:mm:ss",replace:":"},{value:"stamp",key:"Time",index:13,text:"时间戳"}];if(e){var r=t();a.forEach(function(t){e.indexOf(t.text)>-1&&(e=e.replace(t.text,t.replace));var a=e.search(t.reg);t.reg&&-1===a&&(e=r[t.value]+"-"+e)})}var n=t(e);return n.__proto__.format=function(e){var t=this,r=a.find(function(t){return t.format===e||t.value===e});return e=r?r.format:"YYYY-MM-DD hh:mm:ss",a.forEach(function(a){e=e.replace(a.value.repeat(a.index),t[a.value])}),e},n.__proto__.sum=function(e,r){if(this[r]){"M"===r?e--:"W"===r&&(e*=7,r="D");var n=a.find(function(e){return e.value===r}),o=this.Date["set"+n.key](this[r]/1+e);this.Date=new Date(o)}return t(this.Date)},n.__proto__.frametime=function(e,a,r){r||(r="D");var n=t(e).stamp,o=t(a).stamp;n>o&&(n=t(a).stamp,o=t(e).stamp);for(var f=[],i=0;i<=Math.abs(n-o);i+=864e5)!function(e){var a=t(n+e).format(r);-1===f.findIndex(function(e){return e.format(r)===a})&&f.push(t(n+e))}(i);return f},n.__proto__.weekInfo=function(){var e=this,a=this.format("Y")+"-01-01",r=this.format("Y")+"-12-31",n=this.frametime(a,r),o=n.findIndex(function(e){return 7===e.W}),f=[];n.forEach(function(t,a){var r=Math.ceil((a-o)/7);f[r]?f[r].push(t):f[r]=[t],t.format("D")===e.format("D")&&(e.YW=r+1,e.SW=t.sum(-(t.W-1),"D"),e.EW=t.sum(7-t.W,"D"))});var i=this.format("M")+"-01",u=t(i).sum(1,"M").sum(-1,"D").format("D"),m=this.frametime(i,u),s=[];return m.forEach(function(t,a){var r=Math.ceil((a-o)/7);s[r]?s[r].push(t):s[r]=[t],t.format("D")===e.format("D")&&(e.MW=r+1)}),this},n}